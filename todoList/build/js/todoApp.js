'use strict';function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}var todoData=[];var todoApp=new Vue({el:'#todo',data:{todoList:todoData},methods:{getCount:function getCount(){var count=0;this.todoList.forEach(function(item){count+=item.status?0:1});return count},addTodo:function addTodo(){var todoText=document.querySelector('#todo-text');var value=todoText.value.trim();if(value!=''&&this.textLength(value)<=46){var itemId=randomNum();this.todoList.push({todo:value,status:false,id:itemId});todoText.value='';itemId=null}else{alert('提示：请输入有效长度的文字，中文少于23字，英文少于46字')}},addTodoByKey:function addTodoByKey(e){if(e.keyCode==13)this.addTodo()},textLength:function textLength(_text){var realLength=0,len=_text.length;for(var i=0;i<len;i++){realLength+=_text.charCodeAt(i)<128?1:2;}return realLength},xDone:function xDone(){if(this.deleteOrNot()){var len=this.todoList.length-1;for(len;len>=0;--len){if(this.todoList[len].status)this.todoList.splice(len,1)}}},delItem:function delItem(e){var target=e.target;if(target.className&&target.className=='del-item'){if(this.deleteOrNot()){var item=target.parentNode;var wholeItem=item.parentNode.querySelectorAll('li');this.todoList.splice(this.getIndex(item,wholeItem),1)}}},deleteOrNot:function deleteOrNot(){return confirm('确认删除？')?true:false},getIndex:function getIndex(_item,_whole){for(var i=0;i<_whole.length;i++){if(_whole[i]==_item)return i}}}});var filePart=new Vue({el:'#file-box',data:{},methods:{generFile:function generFile(){if(todoData.length>0){var fileName='my_todo_list_'+randomNum()+'.txt';var cutLine='***************************************************************';var blankLine='\r\n\r\n';var contentArr=[];todoData.forEach(function(item,index){var done=item.status?'OK':' ';contentArr.push('('+(index+1)+'). '+item.todo+' ----('+done+')')});var content=generDate()+blankLine+'待办事项：'+blankLine+cutLine+blankLine+contentArr.join(blankLine)+blankLine+cutLine;downloadFile('.generate-file',fileName,content)}else{alert('暂无待办事项')}},importFile:function importFile(e){var _this=this;readFile(e.target.files[0],function(data){todoData.push.apply(todoData,_toConsumableArray(_this.parseData(data)));e.target.value='';e.target.blur()})},parseData:function parseData(_data,_cb){var output=[];var pattern={content:/\*{6,}(.*\r\n*)*\*{6,}/,item:/\(\d+\)\.(.*)/,result:/(.*)-{4}\((.*)\)/};var contain=pattern.content.exec(_data);if(contain){var itemArr=[];contain[0].split('\r\n').forEach(function(item,index){var iContain=pattern.item.exec(item);if(iContain){var result=pattern.result.exec(iContain[1]);var status=result[2]=='OK'?true:false;var itemId=randomNum();output.push({todo:result[1].trim(),status:status,id:itemId})}})}else alert('提示：请按规定格式排版');return output}}});var background=new Vue({el:'#bg',data:{baseUrl:'./img/bg/',imgUrl:'./img/bg/1.png',imgArr:['1.png','2.png','3.png'],imgIndex:0,timeInfo:''},methods:{changeImg:function changeImg(_index){var imgSrc=this.baseUrl+this.imgArr[_index];this.imgUrl=imgSrc},prevImg:function prevImg(){var maxIndex=this.imgArr.length-1;this.imgIndex=this.imgIndex<=0?maxIndex:this.imgIndex-1;this.changeImg(this.imgIndex)},nextImg:function nextImg(){var maxIndex=this.imgArr.length-1;this.imgIndex=this.imgIndex>=maxIndex?0:this.imgIndex+1;this.changeImg(this.imgIndex)},clockTime:function clockTime(){this.timeInfo=generDate()}},computed:{clock:function clock(){var _this2=this;setInterval(function(){_this2.clockTime()},1000)}}});function randomNum(){var time=new Date();return Math.floor(Math.random()*1000)+time.getTime()}function readFile(_file,_cb){var reader=new FileReader();reader.onload=function(){_cb(this.result)};reader.readAsText(_file)}function downloadFile(_el,_fileName,_content){var aTag=document.querySelector(_el);var blob=new Blob([_content]);aTag.download=_fileName;aTag.href=URL.createObjectURL(blob)}function generDate(){var time=new Date();var o={year:time.getFullYear(),month:time.getMonth()+1<10?'0'+(time.getMonth()+1):time.getMonth()+1,date:time.getDate()<10?'0'+time.getDate():time.getDate(),hour:time.getHours()<10?'0'+time.getHours():time.getHours(),minute:time.getMinutes()<10?'0'+time.getMinutes():time.getMinutes(),second:time.getSeconds()<10?'0'+time.getSeconds():time.getSeconds(),day:time.getDay()};var week=['Sun.','Mon.','Tues.','Wed.','Thur.','Fri.','Sat.'];return o.year+'\u5E74'+o.month+'\u6708'+o.date+'\u65E5  '+o.hour+':'+o.minute+':'+o.second+'  '+week[o.day]}